# ğŸ“ æ–‡ä»¶è·¯å¾„ä¿¡æ¯è¯´æ˜

è¿™ä¸ªæ–‡æ¡£è¯´æ˜äº†åº”ç”¨å¯åŠ¨æ—¶ä¼šæ‰“å°çš„æ–‡ä»¶è·¯å¾„ä¿¡æ¯ä»¥åŠå¦‚ä½•æŸ¥çœ‹è¿™äº›ä¿¡æ¯ã€‚

## ğŸ–¥ï¸ å¯åŠ¨æ—¶çš„æ§åˆ¶å°è¾“å‡º

å½“ä½ è¿è¡Œ `npm start` å¯åŠ¨åº”ç”¨æ—¶ï¼Œæ§åˆ¶å°ä¼šæ˜¾ç¤ºè¯¦ç»†çš„è·¯å¾„ä¿¡æ¯ï¼š

### 1. åº”ç”¨è·¯å¾„ä¿¡æ¯
```
=== åº”ç”¨è·¯å¾„ä¿¡æ¯ ===
åº”ç”¨æ•°æ®ç›®å½•: /Users/[username]/Library/Application Support/simple-wms
æ–‡æ¡£ç›®å½•: /Users/[username]/Documents
ä¸‹è½½ç›®å½•: /Users/[username]/Downloads
æ¡Œé¢ç›®å½•: /Users/[username]/Desktop
ä¸´æ—¶ç›®å½•: /tmp
åº”ç”¨ç¨‹åºç›®å½•: /Users/[username]/_git/mofelee/simple-wms/node_modules/electron/dist/Electron.app/Contents/MacOS/Electron
æ—¥å¿—ç›®å½•: /Users/[username]/Library/Logs/simple-wms
==================
```

### 2. IPC å¤„ç†å™¨æ³¨å†Œä¿¡æ¯
```
=== IPC å¤„ç†å™¨æ³¨å†Œ ===
æ­£åœ¨æ³¨å†Œ IPC å¤„ç†å™¨...
å…±æ³¨å†Œ XX ä¸ª IPC é€šé“:
  - user:getById
  - user:getAll
  - user:create
  - user:update
  - user:delete
  - file:read
  - file:write
  - file:exists
  - file:delete
  - system:getInfo
  - system:openFolder
  - system:showNotification
  - system:getAppPaths
  - task:create
  - task:getStatus
  - task:cancel
====================

âœ… æ‰€æœ‰ IPC å¤„ç†å™¨æ³¨å†Œå®Œæˆï¼
```

### 3. æ–‡ä»¶æ“ä½œå®‰å…¨è·¯å¾„ï¼ˆé¦–æ¬¡æ–‡ä»¶æ“ä½œæ—¶ï¼‰
```
=== æ–‡ä»¶æ“ä½œå®‰å…¨è·¯å¾„ ===
å…è®¸çš„åº”ç”¨æ•°æ®ç›®å½•: /Users/[username]/Library/Application Support/simple-wms
å…è®¸çš„æ–‡æ¡£ç›®å½•: /Users/[username]/Documents
æ–‡ä»¶å°†ä¿å­˜åœ¨ä»¥ä¸Šç›®å½•ä¸­
=======================
```

## ğŸ¯ å¦‚ä½•æŸ¥çœ‹è·¯å¾„ä¿¡æ¯

### æ–¹æ³• 1: ç»ˆç«¯è¾“å‡º
1. æ‰“å¼€ç»ˆç«¯å¹¶è¿è¡Œ `npm start`
2. æŸ¥çœ‹ç»ˆç«¯ä¸­æ‰“å°çš„è·¯å¾„ä¿¡æ¯
3. åº”ç”¨å¯åŠ¨åï¼Œè¿™äº›ä¿¡æ¯ä¼šä¿ç•™åœ¨ç»ˆç«¯å†å²ä¸­

### æ–¹æ³• 2: åº”ç”¨å†…æŸ¥çœ‹
1. å¯åŠ¨åº”ç”¨åï¼Œç‚¹å‡» "ğŸ’» ç³»ç»Ÿä¿¡æ¯" æ ‡ç­¾
2. æŸ¥çœ‹ "ğŸ“ åº”ç”¨è·¯å¾„ä¿¡æ¯" éƒ¨åˆ†
3. æ¯ä¸ªè·¯å¾„éƒ½æœ‰å¯¹åº”çš„ "æ‰“å¼€" æŒ‰é’®ï¼Œå¯ä»¥ç›´æ¥åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­æŸ¥çœ‹

### æ–¹æ³• 3: æ—¥å¿—é¢æ¿
1. åº”ç”¨å¯åŠ¨æ—¶ä¼šåœ¨å³ä¾§æ—¥å¿—é¢æ¿æ˜¾ç¤ºç›¸å…³ä¿¡æ¯
2. åŒ…æ‹¬å¯åŠ¨æˆåŠŸæ¶ˆæ¯å’Œè·¯å¾„æç¤º

## ğŸ“‚ é‡è¦è·¯å¾„è¯´æ˜

### åº”ç”¨æ•°æ®ç›®å½•
- **ç”¨é€”**: åº”ç”¨ä¸“ç”¨çš„æ•°æ®å­˜å‚¨ç›®å½•
- **å®‰å…¨æ€§**: å®Œå…¨å®‰å…¨ï¼Œåº”ç”¨æ‹¥æœ‰å®Œæ•´æƒé™
- **ç¤ºä¾‹**: `/Users/[username]/Library/Application Support/simple-wms`
- **è¯´æ˜**: ç›¸å¯¹è·¯å¾„çš„æ–‡ä»¶æ“ä½œä¼šé»˜è®¤ä¿å­˜åˆ°è¿™é‡Œ

### æ–‡æ¡£ç›®å½•
- **ç”¨é€”**: ç”¨æˆ·çš„æ–‡æ¡£æ–‡ä»¶å¤¹
- **å®‰å…¨æ€§**: å—ç³»ç»Ÿæƒé™æ§åˆ¶ï¼Œéœ€è¦ç”¨æˆ·æˆæƒ
- **ç¤ºä¾‹**: `/Users/[username]/Documents`
- **è¯´æ˜**: é€‚åˆä¿å­˜ç”¨æˆ·æ–‡æ¡£ç±»æ–‡ä»¶

### å…¶ä»–ç›®å½•
- **ä¸‹è½½ç›®å½•**: ç”¨æˆ·çš„ä¸‹è½½æ–‡ä»¶å¤¹
- **æ¡Œé¢ç›®å½•**: ç”¨æˆ·çš„æ¡Œé¢æ–‡ä»¶å¤¹
- **ä¸´æ—¶ç›®å½•**: ç³»ç»Ÿä¸´æ—¶æ–‡ä»¶ç›®å½•
- **æ—¥å¿—ç›®å½•**: åº”ç”¨æ—¥å¿—æ–‡ä»¶ç›®å½•

## ğŸ”’ å®‰å…¨æœºåˆ¶

### è·¯å¾„éªŒè¯
æ‰€æœ‰æ–‡ä»¶æ“ä½œéƒ½ä¼šç»è¿‡ä¸¥æ ¼çš„è·¯å¾„éªŒè¯ï¼š

```typescript
// åªå…è®¸åœ¨å®‰å…¨ç›®å½•å†…æ“ä½œ
const allowedPaths = [appDataPath, documentsPath];
const isAllowed = allowedPaths.some(allowedPath => 
  normalizedPath.startsWith(path.normalize(allowedPath))
);

if (!isAllowed) {
  throw new Error('Access denied: Path not in allowed directories');
}
```

### è·¯å¾„éå†é˜²æŠ¤
é˜²æ­¢ `../` ç±»å‹çš„è·¯å¾„éå†æ”»å‡»ï¼š

```typescript
if (normalizedPath.includes('..')) {
  throw new Error('Path traversal not allowed');
}
```

## ğŸ› ï¸ å¼€å‘å’Œè°ƒè¯•

### æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
1. æ‰“å¼€å¼€å‘è€…å·¥å…· (F12)
2. æŸ¥çœ‹ Console é¢æ¿
3. æ‰€æœ‰è·¯å¾„æ“ä½œéƒ½ä¼šæœ‰è¯¦ç»†æ—¥å¿—

### è‡ªå®šä¹‰è·¯å¾„
å¦‚æœéœ€è¦ä¿®æ”¹é»˜è®¤è·¯å¾„ï¼Œå¯ä»¥åœ¨ `src/main/services/file.ts` ä¸­è°ƒæ•´ï¼š

```typescript
const appDataPath = app.getPath('userData');
const documentsPath = app.getPath('documents');
```

### æ·»åŠ æ–°çš„å®‰å…¨ç›®å½•
åœ¨ `fileService.validatePath()` å‡½æ•°ä¸­æ·»åŠ æ–°çš„å…è®¸è·¯å¾„ï¼š

```typescript
const allowedPaths = [
  appDataPath, 
  documentsPath,
  // æ·»åŠ æ–°çš„å®‰å…¨è·¯å¾„
  app.getPath('downloads'),
];
```

## ğŸ“ ç¤ºä¾‹æ–‡ä»¶è·¯å¾„

å½“ä½ åœ¨åº”ç”¨ä¸­è¿›è¡Œæ–‡ä»¶æ“ä½œæ—¶ï¼š

### ç›¸å¯¹è·¯å¾„ç¤ºä¾‹
- è¾“å…¥: `config.json`
- å®é™…ä¿å­˜: `/Users/[username]/Library/Application Support/simple-wms/config.json`

### å­ç›®å½•ç¤ºä¾‹
- è¾“å…¥: `data/users.json`
- å®é™…ä¿å­˜: `/Users/[username]/Library/Application Support/simple-wms/data/users.json`

### ç»å¯¹è·¯å¾„ç¤ºä¾‹ï¼ˆæ–‡æ¡£ç›®å½•ï¼‰
- è¾“å…¥: `/Users/[username]/Documents/myfile.txt`
- å®é™…ä¿å­˜: `/Users/[username]/Documents/myfile.txt`

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡è¿è¡Œ**: åº”ç”¨æ•°æ®ç›®å½•åœ¨é¦–æ¬¡è¿è¡Œæ—¶ä¼šè‡ªåŠ¨åˆ›å»º
2. **æƒé™é—®é¢˜**: è®¿é—®æ–‡æ¡£ç›®å½•å¯èƒ½éœ€è¦ç”¨æˆ·æˆæƒï¼ˆmacOSï¼‰
3. **è·¯å¾„åˆ†éš”ç¬¦**: åº”ç”¨ä¼šè‡ªåŠ¨å¤„ç†ä¸åŒæ“ä½œç³»ç»Ÿçš„è·¯å¾„åˆ†éš”ç¬¦
4. **ä¸­æ–‡è·¯å¾„**: æ”¯æŒåŒ…å«ä¸­æ–‡å­—ç¬¦çš„è·¯å¾„å
5. **ç©ºé—´é™åˆ¶**: ç¡®ä¿ç›®æ ‡ç£ç›˜æœ‰è¶³å¤Ÿçš„å­˜å‚¨ç©ºé—´

é€šè¿‡è¿™äº›è·¯å¾„ä¿¡æ¯ï¼Œä½ å¯ä»¥å‡†ç¡®çŸ¥é“æ–‡ä»¶ä¿å­˜åœ¨ç³»ç»Ÿçš„å“ªä¸ªä½ç½®ï¼Œæ–¹ä¾¿è¿›è¡Œæ–‡ä»¶ç®¡ç†å’Œå¤‡ä»½æ“ä½œã€‚
